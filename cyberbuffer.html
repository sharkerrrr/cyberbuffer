<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èµ›åšæ‹œä½› - Cyber Buddha</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        body {
            font-family: 'Orbitron', monospace;
            background: linear-gradient(45deg, #0a0a0a, #1a0033, #000066);
            animation: bgShift 10s ease-in-out infinite alternate;
        }
        
        @keyframes bgShift {
            0% { background: linear-gradient(45deg, #0a0a0a, #1a0033, #000066); }
            100% { background: linear-gradient(45deg, #000066, #330066, #0a0a0a); }
        }
        
        .neon-text {
            text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 30px #00ffff;
            animation: neonPulse 2s ease-in-out infinite alternate;
        }
        
        @keyframes neonPulse {
            0% { text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff, 0 0 30px #00ffff; }
            100% { text-shadow: 0 0 20px #ff00ff, 0 0 30px #ff00ff, 0 0 40px #ff00ff; }
        }
        
        .buddha-container {
            background: linear-gradient(135deg, rgba(0,255,255,0.1), rgba(255,0,255,0.1));
            border: 2px solid #00ffff;
            box-shadow: 0 0 30px rgba(0,255,255,0.3), inset 0 0 30px rgba(255,0,255,0.1);
            animation: containerGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes containerGlow {
            0% { box-shadow: 0 0 30px rgba(0,255,255,0.3), inset 0 0 30px rgba(255,0,255,0.1); }
            100% { box-shadow: 0 0 50px rgba(255,0,255,0.5), inset 0 0 50px rgba(0,255,255,0.2); }
        }
        
        .cyber-button {
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border: none;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .cyber-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0,255,255,0.8);
        }
        
        .cyber-button:active:not(:disabled) {
            transform: scale(0.95);
        }
        
        .cyber-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: linear-gradient(45deg, #666666, #888888);
        }
        
        .merit-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: #00ffff;
            border-radius: 50%;
            pointer-events: none;
            animation: floatUp 2s ease-out forwards;
        }
        
        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0);
            }
        }
        
        .blessing-text {
            animation: fadeInOut 3s ease-in-out;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0; transform: translateY(20px); }
            50% { opacity: 1; transform: translateY(0); }
        }
        
        .lotus-glow {
            filter: drop-shadow(0 0 10px #ff00ff);
            animation: lotusFloat 4s ease-in-out infinite;
        }
        
        @keyframes lotusFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(5deg); }
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #00ffff, #ff00ff, #00ffff);
            background-size: 200% 100%;
            animation: progressShine 2s linear infinite;
        }
        
        @keyframes progressShine {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .merit-popup {
            position: absolute;
            top: -60px;
            left: 50%;
            transform: translateX(-50%);
            color: #00ffff;
            font-weight: bold;
            font-size: 24px;
            text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff;
            pointer-events: none;
            z-index: 100;
            animation: meritPopup 1s ease-out forwards;
        }
        
        @keyframes meritPopup {
            0% {
                opacity: 0;
                transform: translateX(-50%) scale(0.3);
            }
            30% {
                opacity: 1;
                transform: translateX(-50%) scale(1.2);
            }
            60% {
                opacity: 1;
                transform: translateX(-50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) scale(1) translateY(-20px);
            }
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">
    <!-- å·¦ä¸Šè§’èˆåˆ©å­æ˜¾ç¤º -->
    <div class="fixed top-4 left-4 z-50">
        <div class="bg-gradient-to-r from-pink-600 to-purple-600 bg-opacity-90 backdrop-blur-sm text-white px-4 py-2 rounded-full font-bold text-sm shadow-lg border border-pink-400">
            <span class="text-pink-200">èˆåˆ©</span>
            <span class="text-pink-200 ml-1">âœ¨</span>
            <span id="topRelicCount" class="ml-1" style="text-shadow: 0 0 10px #ff69b4;">0</span>
        </div>
    </div>

    <!-- é¡¶éƒ¨æŒ‰é’®ç»„ -->
    <div class="fixed top-4 right-4 z-50 flex gap-2">
        <button id="shareButton" class="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white px-4 py-2 rounded-full font-bold text-sm transition-all duration-300 hover:scale-105 shadow-lg">
            ğŸ“¢ å¸ƒé“
        </button>
        <button id="loginButton" class="bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white px-4 py-2 rounded-full font-bold text-sm transition-all duration-300 hover:scale-105 shadow-lg">
            ğŸ‘¤ æ³•å·
        </button>
    </div>
    
    <div class="max-w-md w-full">
        <!-- æ ‡é¢˜ -->
        <h1 class="text-6xl font-bold text-center mb-4 neon-text">
            èµ›åšæ‹œä½›
        </h1>
        <p class="text-center text-cyan-300 mb-4 text-sm">
            CYBER BUDDHA v2.088
        </p>
        
        <!-- ä½›åƒå®¹å™¨ -->
        <div class="buddha-container rounded-2xl p-8 mb-6 text-center relative overflow-hidden">
            <!-- è²èŠ±è£…é¥° -->
            <div class="lotus-glow text-6xl mb-4">ğŸª·</div>
            
            <!-- ä½›åƒ -->
            <div class="text-8xl mb-4 relative">
                <span id="buddha" class="inline-block transition-transform duration-300">ğŸ§˜â€â™‚ï¸</span>
            </div>
            
            <!-- åŠŸå¾·æ˜¾ç¤º -->
            <div class="text-cyan-300 mb-4">
                <div class="text-sm mb-2">åŠŸå¾·å€¼ MERIT POINTS</div>
                <div class="text-3xl font-bold neon-text" id="meritCount">0</div>
            </div>
            
            <!-- æ—¶é—´æ˜¾ç¤º -->
            <div class="text-red-300 mb-4">
                <div class="text-sm mb-2">æ—¶é—´å€¼ TIME POINTS</div>
                <div class="text-2xl font-bold" id="lifeCount" style="text-shadow: 0 0 10px #ff6b6b;">120</div>
                <div class="w-full bg-gray-800 rounded-full h-2 mt-2 overflow-hidden">
                    <div class="bg-gradient-to-r from-red-500 to-orange-500 h-full rounded-full transition-all duration-500" id="lifeBar" style="width: 100%"></div>
                </div>
            </div>

            <!-- è´¢å¯Œæ˜¾ç¤º -->
            <div class="text-yellow-300 mb-4">
                <div class="text-sm mb-2">è´¢å¯Œå€¼ WEALTH POINTS</div>
                <div class="text-2xl font-bold" id="wealthCount" style="text-shadow: 0 0 10px #ffd700;">60</div>
                <div class="w-full bg-gray-800 rounded-full h-2 mt-2 overflow-hidden">
                    <div class="bg-gradient-to-r from-yellow-500 to-amber-500 h-full rounded-full transition-all duration-500" id="wealthBar" style="width: 60%"></div>
                </div>
            </div>

            <!-- èˆåˆ©æ˜¾ç¤º -->
            <div class="text-pink-300 mb-4">
                <div class="text-sm mb-2">èˆåˆ© RELIC GEMS âœ¨</div>
                <div class="text-2xl font-bold" id="relicCount" style="text-shadow: 0 0 10px #ff69b4;">0</div>
                <div class="text-xs text-gray-400 mt-1">
                    ä¸‹æ¬¡è·å¾—: <span id="nextRelicTime">--:--</span>
                </div>
            </div>

            <!-- æœºç¼˜ç³»ç»Ÿæ˜¾ç¤º -->
            <div class="text-orange-300 mb-4">
                <div class="text-sm mb-2">æœºç¼˜å€¼ FORTUNE POINTS ğŸ€</div>
                <div class="text-lg font-bold" id="fortuneCount" style="text-shadow: 0 0 10px #ffa500;">0/15</div>
                <div class="w-full bg-gray-800 rounded-full h-2 mt-2 overflow-hidden">
                    <div class="bg-gradient-to-r from-orange-500 to-yellow-500 h-full rounded-full transition-all duration-500" id="fortuneBar" style="width: 0%"></div>
                </div>
                <div class="text-xs text-gray-400 mt-1">
                    æ¯15æ¬¡è¡ŒåŠ¨è§¦å‘ä¸€æ¬¡æœºç¼˜
                </div>
            </div>
            
            <!-- æ—¶é—´è¡°å‡æç¤º -->
            <div class="text-orange-300 mb-4">
                <div class="text-xs text-center p-2 bg-black bg-opacity-30 rounded-lg border border-orange-500">
                    â° <span class="text-red-400">æ—¶é—´æ¯2åˆ†é’Ÿè‡ªç„¶å‡å°‘1ç‚¹</span><br>
                    ğŸ’€ <span class="text-gray-400">æ—¶é—´ä¸º0æ—¶æˆå°±èˆåˆ©äº§å‡ºæš‚åœ</span>
                </div>
            </div>
            
            <!-- è¿›åº¦æ¡ -->
            <div class="w-full bg-gray-800 rounded-full h-2 mb-4 overflow-hidden">
                <div class="progress-bar h-full rounded-full transition-all duration-500" id="progressBar" style="width: 0%"></div>
            </div>
            
            <!-- ç­‰çº§æ˜¾ç¤º -->
            <div class="text-purple-300 text-sm mb-4">
                å¢ƒç•Œ: <span id="level" class="font-bold">å‡¡äºº</span>
            </div>
        </div>
        
        <!-- ä¿®è¡Œé€‰é¡¹ -->
        <div class="grid grid-cols-2 gap-3 mb-4">
            <button id="prayButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ™ æ‹œä½›ç¥ˆç¦</span>
                <div class="text-xs text-gray-800 mt-1">+3-8 åŠŸå¾· | -1 æ—¶é—´ | å…è´¹</div>
            </button>
            
            <button id="drumButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ¥ æ•²æœ¨é±¼</span>
                <div class="text-xs text-gray-800 mt-1">+5-12 åŠŸå¾· | -1 æ—¶é—´ | -4 è´¢å¯Œ</div>
            </button>
            
            <button id="charityButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ’ è¡Œå–„äº‹</span>
                <div class="text-xs text-gray-800 mt-1">+12-25 åŠŸå¾· | +4 æ—¶é—´ | -15 è´¢å¯Œ</div>
            </button>
            
            <button id="scriptButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ“œ æŠ„ç»ä¹¦</span>
                <div class="text-xs text-gray-800 mt-1">+18-35 åŠŸå¾· | -2 æ—¶é—´ | -8 è´¢å¯Œ</div>
            </button>
            
            <button id="fastButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ¥¬ åƒæ–‹å¿µä½›</span>
                <div class="text-xs text-gray-800 mt-1">+8-15 åŠŸå¾· | +2 æ—¶é—´ | -5 è´¢å¯Œ</div>
            </button>
            
            <button id="meditateButton" class="cyber-button py-3 px-4 rounded-xl text-black font-bold text-sm relative">
                <span class="relative z-10">ğŸ§˜ ç¦…å®šå†¥æƒ³</span>
                <div class="text-xs text-gray-800 mt-1">+25-50 åŠŸå¾· | -5 æ—¶é—´ | å…è´¹</div>
            </button>
        </div>
        
        <!-- èµšé’±é€‰é¡¹ -->
        <div class="mb-4 p-4 bg-black bg-opacity-50 rounded-xl border border-yellow-500">
            <h3 class="text-yellow-300 font-bold mb-3 text-center text-sm">ğŸ’° èµšå–è´¢å¯Œ EARN WEALTH</h3>
            <div class="grid grid-cols-2 gap-2">
                <button id="workButton" class="bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 py-2 px-3 rounded-lg text-white font-bold text-xs transition-all duration-300">
                    ğŸ’¼ æ‰“å·¥èµšé’±
                    <div class="text-xs text-green-200 mt-1">+8-15 è´¢å¯Œ | -3 æ—¶é—´</div>
                </button>
                
                <button id="businessButton" class="bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 py-2 px-3 rounded-lg text-white font-bold text-xs transition-all duration-300">
                    ğŸª ç»å•†è´¸æ˜“
                    <div class="text-xs text-blue-200 mt-1">+15-25 è´¢å¯Œ | -5 æ—¶é—´</div>
                </button>
            </div>
        </div>

        <!-- èˆåˆ©å•†åº— -->
        <div class="mb-4 p-4 bg-black bg-opacity-50 rounded-xl border border-pink-500">
            <h3 class="text-pink-300 font-bold mb-3 text-center text-sm">âœ¨ èˆåˆ©å•†åº— RELIC SHOP</h3>
            <button id="relicShopButton" class="w-full bg-gradient-to-r from-pink-600 to-purple-600 hover:from-pink-700 hover:to-purple-700 py-2 px-4 rounded-lg text-white font-bold text-sm transition-all duration-300">
                ğŸ›’ æ‰“å¼€å•†åº—
                <div class="text-xs text-pink-200 mt-1">å…‘æ¢ç¤¼å“ | å»¶ç»­æ—¶é—´</div>
            </button>
        </div>
        
        <!-- ç¥ç¦æ–‡å­—æ˜¾ç¤ºåŒºåŸŸ -->
        <div id="blessingArea" class="h-16 flex items-center justify-center">
            <div id="blessingText" class="text-center text-cyan-300 font-bold"></div>
        </div>
        
        <!-- æˆå°±ç³»ç»Ÿ -->
        <div class="mt-6 p-4 bg-black bg-opacity-50 rounded-xl border border-purple-500">
            <h3 class="text-purple-300 font-bold mb-3 text-center">æˆå°±ç³»ç»Ÿ ACHIEVEMENTS</h3>
            <div id="achievements" class="space-y-2 text-sm">
                <div class="achievement text-gray-500" data-requirement="15" data-relic="1">
                    <span class="mr-2">ğŸ”’</span>åˆå¿ƒè€… - ä¿®è¡Œ15æ¬¡ <span class="text-pink-400">(+1âœ¨/æ—¶)</span>
                </div>
                <div class="achievement text-gray-500" data-requirement="50" data-relic="2">
                    <span class="mr-2">ğŸ”’</span>è™”è¯šè€… - ä¿®è¡Œ50æ¬¡ <span class="text-pink-400">(+2âœ¨/æ—¶)</span>
                </div>
                <div class="achievement text-gray-500" data-requirement="150" data-relic="4">
                    <span class="mr-2">ğŸ”’</span>ä¿®è¡Œè€… - ä¿®è¡Œ150æ¬¡ <span class="text-pink-400">(+4âœ¨/æ—¶)</span>
                </div>
                <div class="achievement text-gray-500" data-requirement="30" data-relic="3">
                    <span class="mr-2">ğŸ”’</span>å–„è¡Œè€… - è¡Œå–„äº‹30æ¬¡ <span class="text-pink-400">(+3âœ¨/æ—¶)</span>
                </div>
                <div class="achievement text-gray-500" data-requirement="400" data-relic="6">
                    <span class="mr-2">ğŸ”’</span>è§‰æ‚Ÿè€… - ä¿®è¡Œ400æ¬¡ <span class="text-pink-400">(+6âœ¨/æ—¶)</span>
                </div>
                <div class="achievement text-gray-500" data-requirement="1500" data-relic="10">
                    <span class="mr-2">ğŸ”’</span>å¤§å¸ˆ - åŠŸå¾·å€¼1500 <span class="text-pink-400">(+10âœ¨/æ—¶)</span>
                </div>
            </div>
            <div class="mt-3 text-xs text-gray-400 text-center">
                è§£é”æˆå°±åæ¯å°æ—¶è‡ªåŠ¨è·å¾—èˆåˆ© â°
            </div>
        </div>
        
        <!-- æ¸¸æˆè¯´æ˜ -->
        <div class="mt-8 p-6 bg-black bg-opacity-60 rounded-2xl border border-cyan-400 max-w-4xl mx-auto">
            <h3 class="text-2xl font-bold text-center mb-6 neon-text">ğŸ“– æ¸¸æˆè¯´æ˜</h3>
            
            <div class="grid md:grid-cols-2 gap-6">
                <!-- åŠŸèƒ½è¯´æ˜ -->
                <div class="bg-gradient-to-br from-purple-900 to-indigo-900 p-4 rounded-xl border border-purple-400">
                    <h4 class="text-purple-300 font-bold mb-3 text-lg">ğŸ® åŠŸèƒ½ç³»ç»Ÿ</h4>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div><span class="text-cyan-400">æ³•å·ï¼š</span>ç™»å½•ç³»ç»Ÿï¼Œä¸ªäººè´¦å·</div>
                        <div><span class="text-purple-400">å¸ƒé“ï¼š</span>åˆ†äº«ç³»ç»Ÿï¼Œé‚€è¯·åŠ å…¥</div>
                        <div><span class="text-green-400">åŸºç¡€è¡Œä¸ºï¼š</span>ä¸åŒä¿®è¡Œæ–¹å¼è·å¾—ä¸åŒåŠŸå¾·ï¼Œéƒ¨åˆ†éœ€è¦è´¢å¯Œæ”¯æŒ</div>
                        <div><span class="text-yellow-400">èµšå–è´¢å¯Œï¼š</span>æ¶ˆè€—æ—¶é—´è·å¾—è´¢å¯Œï¼Œæ”¯æŒä¿®è¡Œæ´»åŠ¨</div>
                        <div><span class="text-orange-400">æœºç¼˜ï¼š</span>æ¯å®Œæˆ15ä¸ªè¡Œä¸ºè§¦å‘éšæœºå¥–åŠ±äº‹ä»¶</div>
                        <div><span class="text-blue-400">æˆå°±ï¼š</span>å®Œæˆç‰¹å®šç›®æ ‡è§£é”æˆå°±ï¼ŒæŒç»­äº§å‡ºèˆåˆ©</div>
                        <div><span class="text-pink-400">èˆåˆ©ï¼š</span>é€šè¿‡æˆå°±äº§å‡ºï¼Œå¯å…‘æ¢å¥–åŠ±æˆ–å»¶ç»­æ—¶é—´</div>
                        <div><span class="text-red-400">ç§¯åˆ†å•†åº—ï¼š</span>ä½¿ç”¨èˆåˆ©å…‘æ¢åŠŸèƒ½å¡æˆ–å»¶ç»­æ—¶é—´</div>
                        <div><span class="text-cyan-400">å†·å´ç³»ç»Ÿï¼š</span>ä¿®è¡ŒæŒ‰é’®æœ‰3ç§’å†·å´ï¼Œé˜²æ­¢åˆ·å±</div>
                    </div>
                </div>
                
                <!-- æ•°å€¼è¯´æ˜ -->
                <div class="bg-gradient-to-br from-cyan-900 to-blue-900 p-4 rounded-xl border border-cyan-400">
                    <h4 class="text-cyan-300 font-bold mb-3 text-lg">ğŸ“Š å¹³è¡¡ä¼˜åŒ–</h4>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div><span class="text-cyan-400">åŠŸå¾·ï¼š</span>å„ä¿®è¡Œæ–¹å¼åŠŸå¾·äº§å‡ºæ›´åŠ å¹³è¡¡</div>
                        <div><span class="text-red-400">æ—¶é—´ï¼š</span>åˆå§‹120ç‚¹ï¼Œæ¯2åˆ†é’Ÿå‡å°‘1ç‚¹ï¼Œæ›´å®½æ¾çš„æ—¶é—´ç®¡ç†</div>
                        <div><span class="text-yellow-400">è´¢å¯Œï¼š</span>åˆå§‹60ç‚¹ï¼Œèµšé’±æ•ˆç‡æå‡ï¼Œæ”¯æŒæ›´å¤šä¿®è¡Œ</div>
                        <div><span class="text-orange-400">æœºç¼˜ï¼š</span>15æ¬¡è¡ŒåŠ¨è§¦å‘ï¼Œæ›´é¢‘ç¹çš„æƒŠå–œ</div>
                        <div><span class="text-purple-400">æˆå°±ï¼š</span>é—¨æ§›è°ƒæ•´ï¼Œæ›´åˆç†çš„è¿›åº¦èŠ‚å¥</div>
                        <div><span class="text-pink-400">èˆåˆ©ï¼š</span>äº§å‡ºå¹³è¡¡ï¼Œå•†åº—ä»·æ ¼ä¼˜åŒ–</div>
                        <div><span class="text-cyan-400">å†·å´ï¼š</span>3ç§’å†·å´é˜²æ­¢æ¶æ„åˆ·å±ï¼Œä¿æŒæ¸¸æˆèŠ‚å¥</div>
                    </div>
                </div>
            </div>
            
            <div class="mt-4 text-center text-xs text-gray-400">
                ğŸ™ æ„¿ä½ åœ¨ä¿®è¡Œè·¯ä¸ŠåŠŸå¾·åœ†æ»¡ï¼Œæ™ºæ…§å¢é•¿ âœ¨<br>
                <span class="text-orange-400">âš¡ å½“å‰ä¸ºæµ‹è¯•æ¨¡å¼ï¼šæ—¶é—´æ¯2åˆ†é’Ÿå‡å°‘1ç‚¹ï¼Œèˆåˆ©æ¯åˆ†é’Ÿäº§å‡º</span>
            </div>
        </div>
    </div>

    <!-- æ¸¸æˆç»“æŸå¼¹çª— -->
    <div id="gameOverModal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-60 hidden">
        <div class="bg-gradient-to-br from-red-900 to-black p-8 rounded-2xl border-2 border-red-500 max-w-sm w-full mx-4 text-center">
            <div class="text-6xl mb-4">ğŸ’€</div>
            <h3 class="text-3xl font-bold mb-4 text-red-300">æ—¶é—´è€—å°½</h3>
            <div class="text-gray-300 mb-6">
                <div class="mb-2">ä½ çš„ä¿®è¡Œä¹‹è·¯åˆ°æ­¤ç»“æŸ</div>
                <div class="bg-black bg-opacity-50 p-4 rounded-xl border border-red-500 mb-4">
                    <div class="text-yellow-300 mb-2">æœ€ç»ˆåŠŸå¾·: <span id="finalMerit">0</span></div>
                    <div class="text-purple-300 mb-2">æœ€é«˜å¢ƒç•Œ: <span id="finalLevel">å‡¡äºº</span></div>
                    <div class="text-green-300">ä¿®è¡Œæ¬¡æ•°: <span id="finalPrayCount">0</span></div>
                </div>
                <div class="text-sm text-gray-400">
                    æ„¿ä½ æ¥ä¸–ç»§ç»­ä¿®è¡Œï¼ŒåŠŸå¾·åœ†æ»¡ ğŸ™
                </div>
            </div>
            <button id="restartButton" class="bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-600 hover:to-purple-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300">
                ğŸ”„ é‡æ–°å¼€å§‹
            </button>
        </div>
    </div>

    <!-- ç™»å½•å¼¹çª— -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gradient-to-br from-gray-900 to-cyan-900 p-6 rounded-2xl border-2 border-cyan-400 max-w-sm w-full mx-4 relative">
            <button id="closeLoginModal" class="absolute top-2 right-2 text-cyan-300 hover:text-white text-2xl">&times;</button>
            
            <h3 class="text-2xl font-bold text-center mb-6 neon-text">ğŸ‘¤ ä¿®è¡Œè€…ç™»å½•</h3>
            
            <!-- ç™»å½•è¡¨å• -->
            <div id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-cyan-300 text-sm mb-2">æ³•å· / ç”¨æˆ·å</label>
                    <input type="text" id="username" class="w-full px-3 py-2 bg-black bg-opacity-50 border border-cyan-400 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-300" placeholder="è¯·è¾“å…¥æ‚¨çš„æ³•å·">
                </div>
                
                <div>
                    <label class="block text-cyan-300 text-sm mb-2">å¯†ç </label>
                    <input type="password" id="password" class="w-full px-3 py-2 bg-black bg-opacity-50 border border-cyan-400 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-cyan-300" placeholder="è¯·è¾“å…¥å¯†ç ">
                </div>
                
                <div class="flex gap-2 pt-4">
                    <button id="loginSubmit" class="flex-1 bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white py-2 px-4 rounded-lg font-bold transition-all duration-300">
                        ğŸ” ç™»å½•
                    </button>
                    <button id="registerSubmit" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-2 px-4 rounded-lg font-bold transition-all duration-300">
                        ğŸ“ æ³¨å†Œ
                    </button>
                </div>
                
                <div class="text-center">
                    <button id="guestLogin" class="text-gray-400 hover:text-cyan-300 text-sm transition-colors">
                        ğŸš¶ æ¸¸å®¢æ¨¡å¼ç»§ç»­ä¿®è¡Œ
                    </button>
                </div>
            </div>
            
            <!-- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º -->
            <div id="userInfo" class="hidden">
                <div class="text-center mb-4">
                    <div class="text-6xl mb-2">ğŸ§˜â€â™‚ï¸</div>
                    <div class="text-cyan-300 text-lg font-bold" id="displayUsername">å–„ä¿¡å±…å£«</div>
                    <div class="text-gray-400 text-sm" id="userLevel">ä¿®è¡Œè€…</div>
                </div>
                
                <div class="bg-black bg-opacity-50 p-4 rounded-xl border border-purple-500 mb-4">
                    <div class="text-yellow-300 text-sm mb-2">ä¸ªäººä¿®è¡Œè®°å½•</div>
                    <div class="grid grid-cols-2 gap-2 text-xs">
                        <div class="text-cyan-300">æ€»åŠŸå¾·: <span id="userTotalMerit">0</span></div>
                        <div class="text-green-300">æ€»ä¿®è¡Œ: <span id="userTotalPray">0</span></div>
                        <div class="text-purple-300">æœ€é«˜å¢ƒç•Œ: <span id="userHighestLevel">å‡¡äºº</span></div>
                        <div class="text-orange-300">ä¿®è¡Œå¤©æ•°: <span id="userDays">1</span></div>
                    </div>
                </div>
                
                <div class="flex gap-2">
                    <button id="saveProgress" class="flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300">
                        ğŸ’¾ ä¿å­˜è¿›åº¦
                    </button>
                    <button id="loadProgress" class="flex-1 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300">
                        ğŸ“¥ è¯»å–è¿›åº¦
                    </button>
                </div>
                
                <div class="text-center mt-4">
                    <button id="logout" class="text-gray-400 hover:text-red-300 text-sm transition-colors">
                        ğŸšª é€€å‡ºç™»å½•
                    </button>
                </div>
            </div>
            
            <div class="text-xs text-gray-400 text-center mt-4">
                ç™»å½•åå¯ä¿å­˜ä¿®è¡Œè¿›åº¦ï¼Œè·¨è®¾å¤‡åŒæ­¥ âœ¨
            </div>
        </div>
    </div>

    <!-- èˆåˆ©å­å•†åº—å¼¹çª— -->
    <div id="relicShopModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gradient-to-br from-gray-900 to-pink-900 p-6 rounded-2xl border-2 border-pink-400 max-w-md w-full mx-4 relative max-h-96 overflow-y-auto">
            <button id="closeRelicShop" class="absolute top-2 right-2 text-pink-300 hover:text-white text-2xl">&times;</button>
            
            <h3 class="text-2xl font-bold text-center mb-4 neon-text">âœ¨ èˆåˆ©å•†åº—</h3>
            
            <div class="text-center mb-4">
                <div class="text-pink-300 text-lg">å½“å‰èˆåˆ©: <span id="shopRelicCount" class="font-bold">0</span> âœ¨</div>
            </div>
            
            <!-- æ—¶é—´å…‘æ¢åŒº -->
            <div class="mb-6 p-4 bg-black bg-opacity-50 rounded-xl border border-red-500">
                <h4 class="text-red-300 font-bold mb-3 text-center">ğŸ’– æ—¶é—´å»¶ç»­</h4>
                <div class="grid grid-cols-2 gap-3">
                    <button class="relic-buy-btn bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="life" data-amount="15" data-cost="3">
                        +15 æ—¶é—´
                        <div class="text-xs text-red-200 mt-1">æ¶ˆè€— 3âœ¨</div>
                    </button>
                    <button class="relic-buy-btn bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="life" data-amount="35" data-cost="6">
                        +35 æ—¶é—´
                        <div class="text-xs text-red-200 mt-1">æ¶ˆè€— 6âœ¨</div>
                    </button>
                    <button class="relic-buy-btn bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="life" data-amount="60" data-cost="10">
                        +60 æ—¶é—´
                        <div class="text-xs text-red-200 mt-1">æ¶ˆè€— 10âœ¨</div>
                    </button>
                    <button class="relic-buy-btn bg-gradient-to-r from-red-600 to-pink-600 hover:from-red-700 hover:to-pink-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="life" data-amount="120" data-cost="18">
                        æ»¡æ—¶å¤æ´»
                        <div class="text-xs text-red-200 mt-1">æ¶ˆè€— 18âœ¨</div>
                    </button>
                </div>
            </div>
            
            <!-- ç¤¼å“å…‘æ¢åŒº -->
            <div class="mb-4 p-4 bg-black bg-opacity-50 rounded-xl border border-yellow-500">
                <h4 class="text-yellow-300 font-bold mb-3 text-center">ğŸ çè´µç¤¼å“</h4>
                <div class="space-y-2">
                    <button class="relic-buy-btn w-full bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-700 hover:to-orange-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="gift" data-gift="åŠŸå¾·åŠ é€Ÿå™¨" data-cost="15">
                        ğŸš€ åŠŸå¾·åŠ é€Ÿå™¨
                        <div class="text-xs text-yellow-200 mt-1">ä¿®è¡ŒåŠŸå¾·ç¿»å€1å°æ—¶ | æ¶ˆè€— 15âœ¨</div>
                    </button>
                    <button class="relic-buy-btn w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="gift" data-gift="æ™ºæ…§ä¹‹å…‰" data-cost="25">
                        ğŸ’¡ æ™ºæ…§ä¹‹å…‰
                        <div class="text-xs text-blue-200 mt-1">ç›´æ¥æå‡ä¸€ä¸ªå¢ƒç•Œ | æ¶ˆè€— 25âœ¨</div>
                    </button>
                    <button class="relic-buy-btn w-full bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="gift" data-gift="è´¢å¯Œå®ç®±" data-cost="8">
                        ğŸ’° è´¢å¯Œå®ç®±
                        <div class="text-xs text-green-200 mt-1">è·å¾—40è´¢å¯Œå€¼ | æ¶ˆè€— 8âœ¨</div>
                    </button>
                    <button class="relic-buy-btn w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="gift" data-gift="ä½›ç¥–æŠ¤ä½‘" data-cost="35">
                        ğŸ™ ä½›ç¥–æŠ¤ä½‘
                        <div class="text-xs text-purple-200 mt-1">æ—¶é—´æ¶ˆè€—å‡åŠ24å°æ—¶ | æ¶ˆè€— 35âœ¨</div>
                    </button>
                    <button class="relic-buy-btn w-full bg-gradient-to-r from-pink-600 to-red-600 hover:from-pink-700 hover:to-red-700 text-white py-2 px-3 rounded-lg font-bold text-sm transition-all duration-300" data-type="gift" data-gift="ç¥ç§˜ç¤¼ç›’" data-cost="50">
                        ğŸ ç¥ç§˜ç¤¼ç›’
                        <div class="text-xs text-pink-200 mt-1">éšæœºè·å¾—è¶…çº§å¥–åŠ± | æ¶ˆè€— 50âœ¨</div>
                    </button>
                </div>
            </div>
            
            <div class="text-xs text-gray-400 text-center">
                èˆåˆ©æ¯å°æ—¶æ ¹æ®æˆå°±è‡ªåŠ¨ç”Ÿæˆ â°
            </div>
        </div>
    </div>

    <!-- æœºç¼˜å¼¹çª— -->
    <div id="fortuneModal" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-60 hidden">
        <div class="bg-gradient-to-br from-orange-900 to-yellow-900 p-8 rounded-2xl border-2 border-orange-400 max-w-sm w-full mx-4 text-center relative">
            <div class="text-6xl mb-4 animate-bounce">ğŸ€</div>
            <h3 class="text-3xl font-bold mb-4 text-orange-300 neon-text">æœºç¼˜é™ä¸´</h3>
            
            <div class="bg-black bg-opacity-50 p-6 rounded-xl border border-yellow-500 mb-6">
                <div class="text-yellow-300 text-lg font-bold mb-4" id="fortuneTitle">å¤©é™æœºç¼˜</div>
                <div class="text-white mb-4" id="fortuneDescription">
                    ä¿®è¡Œè·¯ä¸Šï¼Œæœºç¼˜å·§åˆ...
                </div>
                
                <!-- å¥–åŠ±æ˜¾ç¤º -->
                <div class="space-y-2 mb-4" id="fortuneRewards">
                    <div class="text-cyan-300" id="meritReward" style="display: none;">
                        åŠŸå¾· +<span class="font-bold">0</span>
                    </div>
                    <div class="text-red-300" id="lifeReward" style="display: none;">
                        æ—¶é—´ +<span class="font-bold">0</span>
                    </div>
                    <div class="text-yellow-300" id="wealthReward" style="display: none;">
                        è´¢å¯Œ +<span class="font-bold">0</span>
                    </div>
                    <div class="text-pink-300" id="relicReward" style="display: none;">
                        èˆåˆ© +<span class="font-bold">0</span>
                    </div>
                </div>
                
                <div class="text-sm text-gray-400" id="fortuneQuote">
                    "æœºä¸å¯å¤±ï¼Œæ—¶ä¸å†æ¥"
                </div>
            </div>
            
            <button id="claimFortuneButton" class="bg-gradient-to-r from-orange-500 to-yellow-500 hover:from-orange-600 hover:to-yellow-600 text-black px-8 py-3 rounded-xl font-bold text-lg transition-all duration-300 transform hover:scale-105">
                ğŸ é¢†å–æœºç¼˜
            </button>
        </div>
    </div>

    <!-- åˆ†äº«å¼¹çª— -->
    <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="bg-gradient-to-br from-gray-900 to-purple-900 p-6 rounded-2xl border-2 border-cyan-400 max-w-sm w-full mx-4 relative">
            <button id="closeModal" class="absolute top-2 right-2 text-cyan-300 hover:text-white text-2xl">&times;</button>
            
            <h3 class="text-2xl font-bold text-center mb-4 neon-text">ğŸ“¢ å¸ƒé“åˆ†äº«</h3>
            
            <div class="text-center mb-6">
                <div class="text-cyan-300 mb-2">æˆ‘çš„ä¿®è¡Œæˆæœ</div>
                <div class="bg-black bg-opacity-50 p-4 rounded-xl border border-purple-500">
                    <div class="text-yellow-300 text-lg font-bold mb-2">åŠŸå¾·å€¼: <span id="shareMerit">0</span></div>
                    <div class="text-purple-300 mb-2">å¢ƒç•Œ: <span id="shareLevel">å‡¡äºº</span></div>
                    <div class="text-green-300">ä¿®è¡Œæ¬¡æ•°: <span id="sharePrayCount">0</span></div>
                </div>
                
                <!-- ä½›æ•™ç»å…¸å¥å­ -->
                <div class="mt-4 p-3 bg-gradient-to-r from-purple-900 to-indigo-900 rounded-lg border border-cyan-400">
                    <div class="text-xs text-cyan-300 mb-1">ä»Šæ—¥æ³•è¯­</div>
                    <div class="text-sm text-white font-medium" id="buddhistQuote">
                        è¯¸æ¶è«ä½œï¼Œä¼—å–„å¥‰è¡Œï¼Œè‡ªå‡€å…¶æ„ï¼Œæ˜¯è¯¸ä½›æ•™ã€‚
                    </div>
                    <div class="text-xs text-gray-400 mt-1" id="quoteSource">
                        â€”ã€Šä¸ƒä½›é€šæˆ’åˆã€‹
                    </div>
                </div>
            </div>
            
            <div class="text-center mb-4">
                <div class="text-cyan-300 mb-3">åˆ†äº«åˆ°:</div>
                <div class="grid grid-cols-2 gap-3">
                    <button class="share-btn bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors">
                        ğŸ“± å¾®ä¿¡
                    </button>
                    <button class="share-btn bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg transition-colors">
                        ğŸµ æŠ–éŸ³
                    </button>
                    <button class="share-btn bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg transition-colors">
                        ğŸ’¬ QQ
                    </button>
                    <button class="share-btn bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded-lg transition-colors">
                        ğŸ“‹ å¤åˆ¶
                    </button>
                </div>
            </div>
            
            <div class="text-xs text-gray-400 text-center">
                åˆ†äº«ä½ çš„ä¿®è¡Œæˆæœï¼Œä¼ æ’­æ­£èƒ½é‡ âœ¨
            </div>
        </div>
    </div>

    <script>
        let meritPoints = 0;
        let prayCount = 0;
        let currentLevel = 0;
        let lifePoints = 120; // åˆå§‹æ—¶é—´å€¼æå‡åˆ°120
        let wealthPoints = 60; // åˆå§‹è´¢å¯Œå€¼æå‡åˆ°60
        let relicPoints = 0; // èˆåˆ©æ•°é‡
        let gameOver = false;
        let lastRelicTime = Date.now(); // ä¸Šæ¬¡è·å¾—èˆåˆ©çš„æ—¶é—´
        let relicTimer = null; // èˆåˆ©å®šæ—¶å™¨
        let activeBuffs = {}; // æ¿€æ´»çš„å¢ç›Šæ•ˆæœ
        let fortunePoints = 0; // æœºç¼˜å€¼ (0-14)
        let totalActions = 0; // æ€»è¡ŒåŠ¨æ¬¡æ•°
        let buttonCooldowns = {}; // æŒ‰é’®å†·å´çŠ¶æ€
        
        const levels = [
            { name: "å‡¡äºº", requirement: 0, color: "text-gray-300" },
            { name: "ä¿¡å¾’", requirement: 30, color: "text-green-300" },
            { name: "å±…å£«", requirement: 120, color: "text-blue-300" },
            { name: "ä¿®è¡Œè€…", requirement: 300, color: "text-purple-300" },
            { name: "è©è¨", requirement: 600, color: "text-yellow-300" },
            { name: "ä½›é™€", requirement: 1200, color: "text-pink-300" }
        ];
        
        const blessings = {
            pray: [
                "æ„¿ä½ å¿ƒæƒ³äº‹æˆ âœ¨",
                "åŠŸå¾·æ— é‡ ğŸŒŸ",
                "ä½›å…‰æ™®ç…§ ğŸ™",
                "å¹³å®‰å–œä¹ ğŸ˜Š",
                "ç¦æ…§åŒä¿® ğŸ™"
            ],
            drum: [
                "æœ¨é±¼å£°å£°ï¼Œå‡€åŒ–å¿ƒçµ ğŸ¥",
                "æ¢µéŸ³é˜µé˜µï¼Œæ¶ˆé™¤çƒ¦æ¼ ğŸµ",
                "èŠ‚æ‹æœ‰åºï¼Œå¿ƒå¢ƒå¹³å’Œ âš¡",
                "å£°å£°å…¥è€³ï¼Œæ™ºæ…§å¼€å¯ ğŸ§ "
            ],
            charity: [
                "å–„è¡Œç§¯å¾·ï¼Œç¦æŠ¥æ— è¾¹ ğŸ’",
                "åŠ©äººä¸ºä¹ï¼ŒåŠŸå¾·å€å¢ ğŸŒŸ",
                "æ…ˆæ‚²ä¸ºæ€€ï¼Œå–„ç¼˜å¹¿ç»“ ğŸ’–",
                "å¸ƒæ–½è¡Œå–„ï¼Œç¦æ…§åŒä¿® âœ¨"
            ],
            script: [
                "æŠ„ç»æ‚Ÿé“ï¼Œæ™ºæ…§å¢é•¿ ğŸ“œ",
                "ä¸€å­—ä¸€å¥ï¼ŒåŠŸå¾·æ— é‡ âœï¸",
                "ç»æ–‡å…¥å¿ƒï¼Œçƒ¦æ¼æ¶ˆé™¤ ğŸ§˜",
                "ä¹¦å†™ä½›æ³•ï¼Œå¿ƒå¢ƒæ¸…æ˜ ğŸ“š"
            ],
            fast: [
                "æ¸…å¿ƒå¯¡æ¬²ï¼Œèº«å¿ƒå‡€åŒ– ğŸ¥¬",
                "ç´ é£Ÿå…»ç”Ÿï¼Œæ…ˆæ‚²ä¸ºæ€€ ğŸŒ±",
                "æˆ’è¤èŒ¹ç´ ï¼ŒåŠŸå¾·å¢é•¿ ğŸƒ",
                "æ–‹æˆ’æ¸…ä¿®ï¼Œå¿ƒçµçº¯å‡€ âœ¨"
            ],
            meditate: [
                "ç¦…å®šå…¥å¿ƒï¼Œæ™ºæ…§å¼€å¯ ğŸ§˜",
                "å†¥æƒ³é™å¿ƒï¼Œçƒ¦æ¼æ¶ˆæ•£ ğŸŒ¸",
                "å¿ƒå¦‚æ­¢æ°´ï¼Œå¢ƒç•Œæå‡ ğŸ’«",
                "ç¦…æœºé¡¿æ‚Ÿï¼Œå¤§å½»å¤§æ‚Ÿ ğŸŒŸ"
            ]
        };
        
        const buddha = document.getElementById('buddha');
        const meritCountEl = document.getElementById('meritCount');
        const progressBar = document.getElementById('progressBar');
        const levelEl = document.getElementById('level');
        const blessingText = document.getElementById('blessingText');
        const achievements = document.querySelectorAll('.achievement');
        const lifeCountEl = document.getElementById('lifeCount');
        const lifeBar = document.getElementById('lifeBar');
        const wealthCountEl = document.getElementById('wealthCount');
        const wealthBar = document.getElementById('wealthBar');
        const workButton = document.getElementById('workButton');
        const businessButton = document.getElementById('businessButton');
        const relicCountEl = document.getElementById('relicCount');
        const topRelicCountEl = document.getElementById('topRelicCount');
        const nextRelicTimeEl = document.getElementById('nextRelicTime');
        const fortuneCountEl = document.getElementById('fortuneCount');
        const fortuneBar = document.getElementById('fortuneBar');
        
        // èˆåˆ©å­å•†åº—ç›¸å…³å…ƒç´ 
        const relicShopButton = document.getElementById('relicShopButton');
        const relicShopModal = document.getElementById('relicShopModal');
        const closeRelicShop = document.getElementById('closeRelicShop');
        const shopRelicCount = document.getElementById('shopRelicCount');
        const relicBuyButtons = document.querySelectorAll('.relic-buy-btn');
        
        // åˆ†äº«ç›¸å…³å…ƒç´ 
        const shareButton = document.getElementById('shareButton');
        const shareModal = document.getElementById('shareModal');
        const closeModal = document.getElementById('closeModal');
        const shareButtons = document.querySelectorAll('.share-btn');
        const shareMerit = document.getElementById('shareMerit');
        const shareLevel = document.getElementById('shareLevel');
        const sharePrayCount = document.getElementById('sharePrayCount');
        const buddhistQuote = document.getElementById('buddhistQuote');
        const quoteSource = document.getElementById('quoteSource');
        
        // æœºç¼˜ç›¸å…³å…ƒç´ 
        const fortuneModal = document.getElementById('fortuneModal');
        const fortuneTitle = document.getElementById('fortuneTitle');
        const fortuneDescription = document.getElementById('fortuneDescription');
        const fortuneRewards = document.getElementById('fortuneRewards');
        const meritReward = document.getElementById('meritReward');
        const lifeReward = document.getElementById('lifeReward');
        const wealthReward = document.getElementById('wealthReward');
        const relicReward = document.getElementById('relicReward');
        const fortuneQuote = document.getElementById('fortuneQuote');
        const claimFortuneButton = document.getElementById('claimFortuneButton');
        
        // ç™»å½•ç›¸å…³å…ƒç´ 
        const loginButton = document.getElementById('loginButton');
        const loginModal = document.getElementById('loginModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const loginForm = document.getElementById('loginForm');
        const userInfo = document.getElementById('userInfo');
        const username = document.getElementById('username');
        const password = document.getElementById('password');
        const loginSubmit = document.getElementById('loginSubmit');
        const registerSubmit = document.getElementById('registerSubmit');
        const guestLogin = document.getElementById('guestLogin');
        const displayUsername = document.getElementById('displayUsername');
        const userLevel = document.getElementById('userLevel');
        const userTotalMerit = document.getElementById('userTotalMerit');
        const userTotalPray = document.getElementById('userTotalPray');
        const userHighestLevel = document.getElementById('userHighestLevel');
        const userDays = document.getElementById('userDays');
        const saveProgress = document.getElementById('saveProgress');
        const loadProgress = document.getElementById('loadProgress');
        const logout = document.getElementById('logout');
        
        // ä½›æ•™ç»å…¸å¥å­æ•°æ®åº“
        const buddhistQuotes = [
            {
                quote: "è¯¸æ¶è«ä½œï¼Œä¼—å–„å¥‰è¡Œï¼Œè‡ªå‡€å…¶æ„ï¼Œæ˜¯è¯¸ä½›æ•™ã€‚",
                source: "ã€Šä¸ƒä½›é€šæˆ’åˆã€‹"
            },
            {
                quote: "ä¸€åˆ‡æœ‰ä¸ºæ³•ï¼Œå¦‚æ¢¦å¹»æ³¡å½±ï¼Œå¦‚éœ²äº¦å¦‚ç”µï¼Œåº”ä½œå¦‚æ˜¯è§‚ã€‚",
                source: "ã€Šé‡‘åˆšç»ã€‹"
            },
            {
                quote: "è©ææœ¬æ— æ ‘ï¼Œæ˜é•œäº¦éå°ï¼Œæœ¬æ¥æ— ä¸€ç‰©ï¼Œä½•å¤„æƒ¹å°˜åŸƒã€‚",
                source: "ã€Šå…­ç¥–å›ç»ã€‹"
            },
            {
                quote: "è‰²å³æ˜¯ç©ºï¼Œç©ºå³æ˜¯è‰²ï¼Œè‰²ä¸å¼‚ç©ºï¼Œç©ºä¸å¼‚è‰²ã€‚",
                source: "ã€Šå¿ƒç»ã€‹"
            },
            {
                quote: "è‹¥äººæ¬²äº†çŸ¥ï¼Œä¸‰ä¸–ä¸€åˆ‡ä½›ï¼Œåº”è§‚æ³•ç•Œæ€§ï¼Œä¸€åˆ‡å”¯å¿ƒé€ ã€‚",
                source: "ã€Šåä¸¥ç»ã€‹"
            },
            {
                quote: "å¿ƒè‹¥ä¸åŠ¨ï¼Œé£åˆå¥ˆä½•ã€‚ä½ è‹¥ä¸ä¼¤ï¼Œå²æœˆæ— æ™ã€‚",
                source: "ã€Šç¦…å®—è¯­å½•ã€‹"
            },
            {
                quote: "ä¼—ç”Ÿçš†æœ‰ä½›æ€§ï¼Œçš†å ªä½œä½›ã€‚",
                source: "ã€Šæ¶…æ§ƒç»ã€‹"
            },
            {
                quote: "åº”æ— æ‰€ä½è€Œç”Ÿå…¶å¿ƒã€‚",
                source: "ã€Šé‡‘åˆšç»ã€‹"
            },
            {
                quote: "ä¸€èŠ±ä¸€ä¸–ç•Œï¼Œä¸€å¶ä¸€è©æã€‚",
                source: "ã€Šåä¸¥ç»ã€‹"
            },
            {
                quote: "æ”¾ä¸‹å± åˆ€ï¼Œç«‹åœ°æˆä½›ã€‚",
                source: "ã€Šä½›æ•™å…¸æ•…ã€‹"
            },
            {
                quote: "è‹¦æµ·æ— è¾¹ï¼Œå›å¤´æ˜¯å²¸ã€‚",
                source: "ã€Šä½›æ•™ç»å…¸ã€‹"
            },
            {
                quote: "ä¸‡æ³•çš†ç©ºï¼Œå› æœä¸ç©ºã€‚",
                source: "ã€Šä½›æ•™æ•™ä¹‰ã€‹"
            },
            {
                quote: "å¿ƒå‡€åˆ™å›½åœŸå‡€ã€‚",
                source: "ã€Šç»´æ‘©è¯˜ç»ã€‹"
            },
            {
                quote: "æ…ˆæ‚²å–œèˆï¼Œå››æ— é‡å¿ƒã€‚",
                source: "ã€Šä½›æ•™å››æ¢µä½ã€‹"
            },
            {
                quote: "ä¸å¿˜åˆå¿ƒï¼Œæ–¹å¾—å§‹ç»ˆã€‚",
                source: "ã€Šåä¸¥ç»ã€‹"
            }
        ];
        
        // æ¸¸æˆç»“æŸç›¸å…³å…ƒç´ 
        const gameOverModal = document.getElementById('gameOverModal');
        const restartButton = document.getElementById('restartButton');
        const finalMerit = document.getElementById('finalMerit');
        const finalLevel = document.getElementById('finalLevel');
        const finalPrayCount = document.getElementById('finalPrayCount');
        
        let charityCount = 0; // ç”¨äºè¿½è¸ªè¡Œå–„æ¬¡æ•°
        
        // æœºç¼˜äº‹ä»¶æ•°æ®åº“ - ä¼˜åŒ–å¥–åŠ±æ•°å€¼
        const fortuneEvents = [
            {
                title: "å¤©é™ç”˜éœ²",
                description: "ä¿®è¡Œæ—¶å¤©é™ç”˜éœ²ï¼Œæ»‹æ¶¦å¿ƒç”°ï¼ŒåŠŸå¾·å¤§å¢ï¼",
                quote: "å¤©é™ç”˜éœ²æ¶¦å¿ƒç”°ï¼ŒåŠŸå¾·åœ†æ»¡ç¦æ— è¾¹",
                rewards: { merit: [80, 150], life: [8, 18] }
            },
            {
                title: "é‡è§é«˜åƒ§",
                description: "è·¯é‡å¾—é“é«˜åƒ§ï¼Œä¼ æˆä¿®è¡Œå¿ƒæ³•ï¼Œæ™ºæ…§å¤§å¼€ï¼",
                quote: "é«˜åƒ§æŒ‡è·¯ç ´è¿·æ´¥ï¼Œä¸€è¯­ç‚¹é†’æ¢¦ä¸­äºº",
                rewards: { merit: [120, 200], wealth: [15, 25] }
            },
            {
                title: "æ‹¾å¾—å®ç‰©",
                description: "åœ¨å¤å¯ºä¸­å‘ç°çè´µèˆåˆ©ï¼Œä½›å…‰æ™®ç…§ï¼",
                quote: "å¤å¯ºå¯»å®å¾—èˆåˆ©ï¼Œä½›å…‰æ™®ç…§ç¦æ…§é½",
                rewards: { relic: [5, 12], merit: [50, 100] }
            },
            {
                title: "å–„ç¼˜ç›¸åŠ©",
                description: "å› å¾€æ—¥å–„è¡Œï¼Œå¾—åˆ°è´µäººç›¸åŠ©ï¼Œè´¢å¯Œå¢é•¿ï¼",
                quote: "å–„æœ‰å–„æŠ¥å¤©ç†å¾ªï¼Œè´µäººç›¸åŠ©ç¦ä¸´é—¨",
                rewards: { wealth: [25, 40], life: [12, 20] }
            },
            {
                title: "ç¦…æ‚Ÿé¡¿å¼€",
                description: "é™åå†¥æƒ³æ—¶çªç„¶é¡¿æ‚Ÿï¼Œå¢ƒç•Œå¤§å¹…æå‡ï¼",
                quote: "ç¦…å¿ƒä¸€ç‰‡æœˆå¦‚æ°´ï¼Œé¡¿æ‚Ÿäººç”ŸçœŸè°›æ·±",
                rewards: { merit: [150, 300], life: [15, 25] }
            },
            {
                title: "ä½›ç¥–æ˜¾çµ",
                description: "è™”è¯šä¿®è¡Œæ„ŸåŠ¨ä½›ç¥–ï¼Œè·å¾—å…¨é¢åŠ æŒï¼",
                quote: "è™”è¯šæ„ŸåŠ¨ä½›ç¥–å¿ƒï¼Œå…¨é¢åŠ æŒç¦æ…§æ·±",
                rewards: { merit: [100, 180], life: [20, 30], wealth: [20, 35], relic: [3, 8] }
            },
            {
                title: "åŠŸå¾·å›å‘",
                description: "è¿‡å¾€åŠŸå¾·å›å‘ä¼—ç”Ÿï¼Œè·å¾—æ„å¤–ç¦æŠ¥ï¼",
                quote: "åŠŸå¾·å›å‘ä¼—ç”Ÿç¦ï¼Œæ„å¤–ç¦æŠ¥è‡ªç„¶æ¥",
                rewards: { merit: [70, 130], wealth: [18, 30] }
            },
            {
                title: "è²èŠ±ç››å¼€",
                description: "å¿ƒè²ç»½æ”¾ï¼Œèº«å¿ƒå‡€åŒ–ï¼Œæ—¶é—´å»¶é•¿ï¼",
                quote: "å¿ƒè²ç»½æ”¾å‡€å°˜åŸƒï¼Œèº«å¿ƒæ¸…å‡€æ—¶å»¶é•¿",
                rewards: { life: [25, 40], merit: [60, 120] }
            },
            {
                title: "ç»ä¹¦æ„Ÿåº”",
                description: "è¯µè¯»ç»ä¹¦æ—¶äº§ç”Ÿæ„Ÿåº”ï¼Œè·å¾—ç¥ç§˜åŠ›é‡ï¼",
                quote: "ç»ä¹¦æ„Ÿåº”æ˜¾ç¥é€šï¼Œç¥ç§˜åŠ›é‡åŠ©ä¿®è¡Œ",
                rewards: { merit: [110, 200], relic: [2, 6] }
            },
            {
                title: "æ…ˆæ‚²å¿ƒèµ·",
                description: "æ…ˆæ‚²å¿ƒå¤§å‘ï¼Œæ„ŸåŒ–ä¼—ç”Ÿï¼ŒåŠŸå¾·æ— é‡ï¼",
                quote: "æ…ˆæ‚²å¿ƒèµ·æ„Ÿä¼—ç”Ÿï¼ŒåŠŸå¾·æ— é‡ç¦æ…§å¢",
                rewards: { merit: [140, 250], life: [18, 28] }
            },
            {
                title: "è´¢ç¥çœ·é¡¾",
                description: "å› å¸ƒæ–½è¡Œå–„ï¼Œå¾—è´¢ç¥çœ·é¡¾ï¼Œè´¢æºæ»šæ»šï¼",
                quote: "å¸ƒæ–½è¡Œå–„è´¢ç¥é¡¾ï¼Œè´¢æºæ»šæ»šç¦æ»¡é—¨",
                rewards: { wealth: [35, 50], merit: [40, 80] }
            },
            {
                title: "ä»™äººæŒ‡è·¯",
                description: "è¿·é€”ä¸­é‡ä»™äººæŒ‡è·¯ï¼Œè·å¾—äººç”Ÿæ™ºæ…§ï¼",
                quote: "ä»™äººæŒ‡è·¯ç ´è¿·é›¾ï¼Œäººç”Ÿæ™ºæ…§è‡ªç„¶å¼€",
                rewards: { merit: [90, 160], wealth: [12, 22], life: [10, 18] }
            }
        ];
        
        // ç”¨æˆ·ç³»ç»ŸçŠ¶æ€
        let isLoggedIn = false;
        let currentUser = null;
        let userStats = {
            totalMerit: 0,
            totalPray: 0,
            highestLevel: 0,
            registrationDate: null,
            lastLogin: null
        };
        
        // ä¿®è¡ŒåŠ¨ä½œé…ç½® - ä¼˜åŒ–å¹³è¡¡
        const actions = {
            pray: { min: 3, max: 8, type: 'pray', life: -1, wealth: 0 },
            drum: { min: 5, max: 12, type: 'drum', life: -1, wealth: -4 },
            charity: { min: 12, max: 25, type: 'charity', life: 4, wealth: -15 },
            script: { min: 18, max: 35, type: 'script', life: -2, wealth: -8 },
            fast: { min: 8, max: 15, type: 'fast', life: 2, wealth: -5 },
            meditate: { min: 25, max: 50, type: 'meditate', life: -5, wealth: 0 }
        };
        
        // è·å–æŒ‰é’®å…ƒç´ 
        const prayButton = document.getElementById('prayButton');
        const drumButton = document.getElementById('drumButton');
        const charityButton = document.getElementById('charityButton');
        const scriptButton = document.getElementById('scriptButton');
        const fastButton = document.getElementById('fastButton');
        const meditateButton = document.getElementById('meditateButton');
        
        // èµšé’±åŠ¨ä½œé…ç½® - ä¼˜åŒ–å¹³è¡¡
        const wealthActions = {
            work: { min: 8, max: 15, life: -3, wealth: 1 },
            business: { min: 15, max: 25, life: -5, wealth: 1 }
        };
        
        // å†·å´ç³»ç»Ÿå‡½æ•°
        function startCooldown(buttonId, button) {
            const cooldownTime = 3000; // 3ç§’å†·å´
            buttonCooldowns[buttonId] = Date.now() + cooldownTime;
            
            // ç¦ç”¨æŒ‰é’®å¹¶æ”¹å˜æ ·å¼
            button.disabled = true;
            button.style.opacity = '0.5';
            button.style.cursor = 'not-allowed';
            
            // è·å–æŒ‰é’®æ–‡æœ¬å…ƒç´ 
            const buttonText = button.querySelector('span');
            const originalText = buttonText.textContent;
            
            // å¼€å§‹å€’è®¡æ—¶
            const countdown = setInterval(() => {
                const remaining = buttonCooldowns[buttonId] - Date.now();
                
                if (remaining <= 0) {
                    // å†·å´ç»“æŸ
                    clearInterval(countdown);
                    delete buttonCooldowns[buttonId];
                    
                    // æ¢å¤æŒ‰é’®çŠ¶æ€
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    buttonText.textContent = originalText;
                } else {
                    // æ˜¾ç¤ºå€’è®¡æ—¶
                    const seconds = Math.ceil(remaining / 1000);
                    buttonText.textContent = `å†·å´ä¸­... ${seconds}s`;
                }
            }, 100);
        }
        
        function isButtonOnCooldown(buttonId) {
            return buttonCooldowns[buttonId] && Date.now() < buttonCooldowns[buttonId];
        }
        
        // é€šç”¨ä¿®è¡Œå‡½æ•°
        function performAction(actionType, button) {
            if (gameOver) return;
            
            const buttonId = button.id;
            
            // æ£€æŸ¥å†·å´çŠ¶æ€
            if (isButtonOnCooldown(buttonId)) {
                const remaining = Math.ceil((buttonCooldowns[buttonId] - Date.now()) / 1000);
                showBlessing(`â° è¯·ç­‰å¾… ${remaining} ç§’åå†ä¿®è¡Œï¼`);
                return;
            }
            
            const action = actions[actionType];
            
            // æ£€æŸ¥è´¢å¯Œæ˜¯å¦è¶³å¤Ÿ
            if (action.wealth < 0 && wealthPoints + action.wealth < 0) {
                showBlessing("ğŸ’° è´¢å¯Œä¸è¶³ï¼Œæ— æ³•è¿›è¡Œæ­¤ä¿®è¡Œï¼");
                return;
            }
            
            // æ£€æŸ¥æ—¶é—´æ˜¯å¦è¶³å¤Ÿ
            if (action.life < 0 && lifePoints + action.life < 0) {
                showBlessing("âš ï¸ æ—¶é—´ä¸è¶³ï¼Œæ— æ³•è¿›è¡Œæ­¤ä¿®è¡Œï¼");
                return;
            }
            
            // å¼€å§‹å†·å´
            startCooldown(buttonId, button);
            
            const baseMerit = Math.floor(Math.random() * (action.max - action.min + 1)) + action.min;
            const merit = getModifiedMerit(baseMerit);
            const lifeCost = getModifiedLifeCost(Math.abs(action.life));
            
            meritPoints += merit;
            prayCount++;
            totalActions++; // å¢åŠ æ€»è¡ŒåŠ¨æ¬¡æ•°
            fortunePoints++; // å¢åŠ æœºç¼˜å€¼
            lifePoints += action.life < 0 ? -lifeCost : action.life;
            wealthPoints += action.wealth;
            
            // æ˜¾ç¤ºåŠŸå¾·å¢åŠ å¼¹å‡ºæ–‡å­—
            showMeritPopup(merit);
            
            // ç¡®ä¿æ•°å€¼åœ¨åˆç†èŒƒå›´å†…
            if (lifePoints > 120) lifePoints = 120;
            if (wealthPoints > 100) wealthPoints = 100;
            if (wealthPoints < 0) wealthPoints = 0;
            
            if (actionType === 'charity') {
                charityCount++;
            }
            
            // æ£€æŸ¥æœºç¼˜è§¦å‘ - æ”¹ä¸º15æ¬¡
            if (fortunePoints >= 15) {
                fortunePoints = 0; // é‡ç½®æœºç¼˜å€¼
                setTimeout(() => {
                    triggerFortune();
                }, 1000); // å»¶è¿Ÿ1ç§’æ˜¾ç¤ºæœºç¼˜
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
            if (lifePoints <= 0) {
                gameOverSequence();
                return;
            }
            
            // ä½›åƒåŠ¨ç”»
            buddha.style.transform = 'scale(1.2) rotateY(10deg)';
            setTimeout(() => {
                buddha.style.transform = 'scale(1) rotateY(0deg)';
            }, 300);
            
            // åˆ›å»ºåŠŸå¾·ç²’å­æ•ˆæœ
            createMeritParticles();
            
            // æ˜¾ç¤ºå¯¹åº”ç¥ç¦
            showBlessing(null, action.type);
            
            // æ£€æŸ¥æˆå°±
            checkAchievements();
        }
        
        // èµšé’±å‡½æ•°
        function performWealthAction(actionType, button) {
            if (gameOver) return;
            
            const action = wealthActions[actionType];
            
            // æ£€æŸ¥æ—¶é—´æ˜¯å¦è¶³å¤Ÿ
            if (action.life < 0 && lifePoints + action.life < 0) {
                showBlessing("âš ï¸ æ—¶é—´ä¸è¶³ï¼Œæ— æ³•å·¥ä½œï¼");
                return;
            }
            
            const wealth = Math.floor(Math.random() * (action.max - action.min + 1)) + action.min;
            
            totalActions++; // å¢åŠ æ€»è¡ŒåŠ¨æ¬¡æ•°
            fortunePoints++; // å¢åŠ æœºç¼˜å€¼
            lifePoints += action.life;
            wealthPoints += wealth;
            
            // ç¡®ä¿æ•°å€¼åœ¨åˆç†èŒƒå›´å†…
            if (lifePoints > 120) lifePoints = 120;
            if (wealthPoints > 100) wealthPoints = 100;
            
            // æ£€æŸ¥æœºç¼˜è§¦å‘
            if (fortunePoints >= 15) {
                fortunePoints = 0; // é‡ç½®æœºç¼˜å€¼
                setTimeout(() => {
                    triggerFortune();
                }, 1000); // å»¶è¿Ÿ1ç§’æ˜¾ç¤ºæœºç¼˜
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
            if (lifePoints <= 0) {
                gameOverSequence();
                return;
            }
            
            // æ˜¾ç¤ºå¯¹åº”æç¤º
            if (actionType === 'work') {
                showBlessing("ğŸ’¼ è¾›å‹¤å·¥ä½œï¼Œè´¢å¯Œå¢åŠ ï¼");
            } else {
                showBlessing("ğŸª ç”Ÿæ„å…´éš†ï¼Œè´¢æºå¹¿è¿›ï¼");
            }
            
            // æŒ‰é’®åé¦ˆ
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 150);
        }
        
        // æœºç¼˜ç³»ç»Ÿå‡½æ•°
        function triggerFortune() {
            if (gameOver) return;
            
            // éšæœºé€‰æ‹©ä¸€ä¸ªæœºç¼˜äº‹ä»¶
            const randomEvent = fortuneEvents[Math.floor(Math.random() * fortuneEvents.length)];
            
            // è®¡ç®—å¥–åŠ±
            const rewards = {};
            let rewardTexts = [];
            
            Object.keys(randomEvent.rewards).forEach(type => {
                const range = randomEvent.rewards[type];
                const amount = Math.floor(Math.random() * (range[1] - range[0] + 1)) + range[0];
                rewards[type] = amount;
                
                switch(type) {
                    case 'merit':
                        rewardTexts.push(`åŠŸå¾· +${amount}`);
                        break;
                    case 'life':
                        rewardTexts.push(`æ—¶é—´ +${amount}`);
                        break;
                    case 'wealth':
                        rewardTexts.push(`è´¢å¯Œ +${amount}`);
                        break;
                    case 'relic':
                        rewardTexts.push(`èˆåˆ© +${amount}`);
                        break;
                }
            });
            
            // æ˜¾ç¤ºæœºç¼˜å¼¹çª—
            showFortuneModal(randomEvent, rewards);
        }
        
        function showFortuneModal(event, rewards) {
            // è®¾ç½®å¼¹çª—å†…å®¹
            fortuneTitle.textContent = event.title;
            fortuneDescription.textContent = event.description;
            fortuneQuote.textContent = `"${event.quote}"`;
            
            // éšè—æ‰€æœ‰å¥–åŠ±æ˜¾ç¤º
            meritReward.style.display = 'none';
            lifeReward.style.display = 'none';
            wealthReward.style.display = 'none';
            relicReward.style.display = 'none';
            
            // æ˜¾ç¤ºå¯¹åº”å¥–åŠ±
            if (rewards.merit) {
                meritReward.style.display = 'block';
                meritReward.querySelector('span').textContent = rewards.merit;
            }
            if (rewards.life) {
                lifeReward.style.display = 'block';
                lifeReward.querySelector('span').textContent = rewards.life;
            }
            if (rewards.wealth) {
                wealthReward.style.display = 'block';
                wealthReward.querySelector('span').textContent = rewards.wealth;
            }
            if (rewards.relic) {
                relicReward.style.display = 'block';
                relicReward.querySelector('span').textContent = rewards.relic;
            }
            
            // æ˜¾ç¤ºå¼¹çª—
            fortuneModal.classList.remove('hidden');
            fortuneModal.style.opacity = '0';
            setTimeout(() => {
                fortuneModal.style.opacity = '1';
            }, 10);
            
            // ç»‘å®šé¢†å–æŒ‰é’®äº‹ä»¶
            claimFortuneButton.onclick = () => claimFortune(rewards);
        }
        
        function claimFortune(rewards) {
            // åº”ç”¨å¥–åŠ±
            if (rewards.merit) {
                meritPoints += rewards.merit;
                // æ˜¾ç¤ºåŠŸå¾·å¢åŠ å¼¹å‡ºæ–‡å­—
                showMeritPopup(rewards.merit);
            }
            if (rewards.life) {
                lifePoints += rewards.life;
                if (lifePoints > 120) lifePoints = 120;
            }
            if (rewards.wealth) {
                wealthPoints += rewards.wealth;
                if (wealthPoints > 100) wealthPoints = 100;
            }
            if (rewards.relic) {
                relicPoints += rewards.relic;
            }
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            // æ˜¾ç¤ºè·å¾—æç¤º
            let rewardText = "ğŸ€ æœºç¼˜è·å¾—ï¼š";
            if (rewards.merit) rewardText += ` åŠŸå¾·+${rewards.merit}`;
            if (rewards.life) rewardText += ` æ—¶é—´+${rewards.life}`;
            if (rewards.wealth) rewardText += ` è´¢å¯Œ+${rewards.wealth}`;
            if (rewards.relic) rewardText += ` èˆåˆ©+${rewards.relic}`;
            
            showBlessing(rewardText);
            
            // å…³é—­å¼¹çª—
            fortuneModal.style.opacity = '0';
            setTimeout(() => {
                fortuneModal.classList.add('hidden');
            }, 300);
            
            // ç‰¹æ•ˆ
            createMeritParticles();
        }
        
        // ç­‰å¾…DOMåŠ è½½å®Œæˆåç»‘å®šæ‰€æœ‰äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            // ç»‘å®šä¿®è¡ŒæŒ‰é’®äº‹ä»¶
            prayButton.addEventListener('click', () => performAction('pray', prayButton));
            drumButton.addEventListener('click', () => performAction('drum', drumButton));
            charityButton.addEventListener('click', () => performAction('charity', charityButton));
            scriptButton.addEventListener('click', () => performAction('script', scriptButton));
            fastButton.addEventListener('click', () => performAction('fast', fastButton));
            meditateButton.addEventListener('click', () => performAction('meditate', meditateButton));
            
            // ç»‘å®šèµšé’±æŒ‰é’®äº‹ä»¶
            workButton.addEventListener('click', () => performWealthAction('work', workButton));
            businessButton.addEventListener('click', () => performWealthAction('business', businessButton));
            
            // ç»‘å®šèˆåˆ©å­å•†åº—äº‹ä»¶
            relicShopButton.addEventListener('click', openRelicShop);
            closeRelicShop.addEventListener('click', closeRelicShopModal);
            relicShopModal.addEventListener('click', (e) => {
                if (e.target === relicShopModal) closeRelicShopModal();
            });
            
            // ç»‘å®šå•†åº—è´­ä¹°æŒ‰é’®
            relicBuyButtons.forEach(btn => {
                btn.addEventListener('click', () => handleRelicPurchase(btn));
            });
            
            // åˆ†äº«åŠŸèƒ½äº‹ä»¶
            shareButton.addEventListener('click', openShareModal);
            closeModal.addEventListener('click', closeShareModal);
            shareModal.addEventListener('click', (e) => {
                if (e.target === shareModal) closeShareModal();
            });
            
            // åˆ†äº«æŒ‰é’®äº‹ä»¶
            shareButtons.forEach((btn, index) => {
                btn.addEventListener('click', () => handleShare(index));
            });
            
            // ç™»å½•ç³»ç»Ÿäº‹ä»¶
            loginButton.addEventListener('click', openLoginModal);
            closeLoginModal.addEventListener('click', closeLoginModalFunc);
            loginModal.addEventListener('click', (e) => {
                if (e.target === loginModal) closeLoginModalFunc();
            });
            loginSubmit.addEventListener('click', handleLogin);
            registerSubmit.addEventListener('click', handleRegister);
            guestLogin.addEventListener('click', closeLoginModalFunc);
            saveProgress.addEventListener('click', handleSaveProgress);
            loadProgress.addEventListener('click', handleLoadProgress);
            logout.addEventListener('click', handleLogout);
            
            // ç»‘å®šé‡å¯æŒ‰é’®
            restartButton.addEventListener('click', restartGame);
            
            // åˆå§‹åŒ–æ˜¾ç¤ºå’Œå®šæ—¶å™¨
            updateDisplay();
            startRelicTimer();
            startLifeDecay();
            
            // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„ç™»å½•çŠ¶æ€
            const savedLoginUser = localStorage.getItem('currentUser');
            if (savedLoginUser) {
                const userData = localStorage.getItem('user_' + savedLoginUser);
                if (userData) {
                    isLoggedIn = true;
                    currentUser = savedLoginUser;
                    userStats = JSON.parse(userData).stats || userStats;
                    loginButton.innerHTML = `ğŸ‘¤ ${savedLoginUser}`;
                }
            }
        });
        
        function updateDisplay() {
            meritCountEl.textContent = meritPoints;
            lifeCountEl.textContent = lifePoints;
            wealthCountEl.textContent = wealthPoints;
            relicCountEl.textContent = relicPoints;
            topRelicCountEl.textContent = relicPoints;
            fortuneCountEl.textContent = fortunePoints + '/15';
            
            // æ›´æ–°æœºç¼˜è¿›åº¦æ¡
            const fortunePercentage = (fortunePoints / 15) * 100;
            fortuneBar.style.width = fortunePercentage + '%';
            
            // æ›´æ–°å¯¿å‘½æ¡
            const lifePercentage = (lifePoints / 120) * 100;
            lifeBar.style.width = Math.max(lifePercentage, 0) + '%';
            
            // æ ¹æ®æ—¶é—´å€¼æ”¹å˜é¢œè‰²
            if (lifePoints <= 25) {
                lifeBar.className = 'bg-gradient-to-r from-red-600 to-red-800 h-full rounded-full transition-all duration-500';
                lifeCountEl.style.color = '#ff6b6b';
            } else if (lifePoints <= 60) {
                lifeBar.className = 'bg-gradient-to-r from-yellow-500 to-orange-500 h-full rounded-full transition-all duration-500';
                lifeCountEl.style.color = '#ffa500';
            } else {
                lifeBar.className = 'bg-gradient-to-r from-red-500 to-orange-500 h-full rounded-full transition-all duration-500';
                lifeCountEl.style.color = '#ff6b6b';
            }
            
            // æ›´æ–°è´¢å¯Œæ¡
            const wealthPercentage = (wealthPoints / 100) * 100;
            wealthBar.style.width = Math.max(wealthPercentage, 0) + '%';
            
            // æ ¹æ®è´¢å¯Œå€¼æ”¹å˜é¢œè‰²
            if (wealthPoints <= 15) {
                wealthBar.className = 'bg-gradient-to-r from-gray-500 to-gray-600 h-full rounded-full transition-all duration-500';
                wealthCountEl.style.color = '#ffd700';
            } else if (wealthPoints <= 40) {
                wealthBar.className = 'bg-gradient-to-r from-yellow-600 to-yellow-700 h-full rounded-full transition-all duration-500';
                wealthCountEl.style.color = '#ffd700';
            } else {
                wealthBar.className = 'bg-gradient-to-r from-yellow-500 to-amber-500 h-full rounded-full transition-all duration-500';
                wealthCountEl.style.color = '#ffd700';
            }
            
            // æ›´æ–°ç­‰çº§
            for (let i = levels.length - 1; i >= 0; i--) {
                if (meritPoints >= levels[i].requirement) {
                    if (currentLevel !== i) {
                        currentLevel = i;
                        levelEl.textContent = levels[i].name;
                        levelEl.className = levels[i].color + ' font-bold';
                        
                        // å‡çº§ç‰¹æ•ˆ
                        if (i > 0) {
                            showBlessing("ğŸ‰ å¢ƒç•Œæå‡ï¼" + levels[i].name + " ğŸ‰");
                        }
                    }
                    break;
                }
            }
            
            // æ›´æ–°è¿›åº¦æ¡
            const nextLevel = levels[currentLevel + 1];
            if (nextLevel) {
                const currentReq = levels[currentLevel].requirement;
                const nextReq = nextLevel.requirement;
                const progress = ((meritPoints - currentReq) / (nextReq - currentReq)) * 100;
                progressBar.style.width = Math.min(progress, 100) + '%';
            } else {
                progressBar.style.width = '100%';
            }
        }
        
        function createMeritParticles() {
            const container = document.querySelector('.buddha-container');
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'merit-particle';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = '80%';
                    particle.style.background = Math.random() > 0.5 ? '#00ffff' : '#ff00ff';
                    container.appendChild(particle);
                    
                    setTimeout(() => {
                        particle.remove();
                    }, 2000);
                }, i * 100);
            }
        }
        
        function showMeritPopup(meritGained) {
            const buddhaContainer = document.querySelector('.buddha-container');
            const buddhaElement = document.getElementById('buddha');
            
            // åˆ›å»ºåŠŸå¾·å¼¹å‡ºæ–‡å­—
            const popup = document.createElement('div');
            popup.className = 'merit-popup';
            popup.textContent = `åŠŸå¾·å€¼+${meritGained}`;
            
            // å°†å¼¹å‡ºæ–‡å­—æ·»åŠ åˆ°ä½›åƒå®¹å™¨ä¸­ï¼Œç›¸å¯¹äºä½›åƒä½ç½®
            buddhaContainer.style.position = 'relative';
            buddhaElement.style.position = 'relative';
            buddhaElement.appendChild(popup);
            
            // 1ç§’åç§»é™¤å¼¹å‡ºæ–‡å­—
            setTimeout(() => {
                if (popup.parentNode) {
                    popup.parentNode.removeChild(popup);
                }
            }, 1000);
        }
        
        function showBlessing(customText = null, actionType = 'pray') {
            let blessing;
            if (customText) {
                blessing = customText;
            } else {
                const actionBlessings = blessings[actionType];
                blessing = actionBlessings[Math.floor(Math.random() * actionBlessings.length)];
            }
            
            blessingText.textContent = blessing;
            blessingText.className = 'blessing-text text-center text-cyan-300 font-bold';
            
            setTimeout(() => {
                blessingText.textContent = '';
                blessingText.className = 'text-center text-cyan-300 font-bold';
            }, 3000);
        }
        
        function checkAchievements() {
            achievements.forEach((achievement, index) => {
                const requirement = parseInt(achievement.dataset.requirement);
                let unlocked = false;
                
                // æ ¹æ®ä¸åŒæˆå°±ç±»å‹æ£€æŸ¥æ¡ä»¶
                switch(index) {
                    case 0: // åˆå¿ƒè€… - ä¿®è¡Œ15æ¬¡
                        unlocked = prayCount >= 15;
                        break;
                    case 1: // è™”è¯šè€… - ä¿®è¡Œ50æ¬¡
                        unlocked = prayCount >= 50;
                        break;
                    case 2: // ä¿®è¡Œè€… - ä¿®è¡Œ150æ¬¡
                        unlocked = prayCount >= 150;
                        break;
                    case 3: // å–„è¡Œè€… - è¡Œå–„äº‹30æ¬¡
                        unlocked = charityCount >= 30;
                        break;
                    case 4: // è§‰æ‚Ÿè€… - ä¿®è¡Œ400æ¬¡
                        unlocked = prayCount >= 400;
                        break;
                    case 5: // å¤§å¸ˆ - åŠŸå¾·å€¼1500
                        unlocked = meritPoints >= 1500;
                        break;
                }
                
                if (unlocked && achievement.classList.contains('text-gray-500')) {
                    achievement.classList.remove('text-gray-500');
                    achievement.classList.add('text-yellow-300');
                    achievement.querySelector('span').textContent = 'ğŸ†';
                    
                    // æˆå°±è§£é”ç‰¹æ•ˆ
                    const achievementName = achievement.textContent.split(' - ')[0].replace('ğŸ”’', '');
                    showBlessing("ğŸ† æˆå°±è§£é”ï¼" + achievementName + " ğŸ†");
                }
            });
        }
        
        // åˆ†äº«åŠŸèƒ½å‡½æ•°
        function openShareModal() {
            // æ›´æ–°åˆ†äº«æ•°æ®
            shareMerit.textContent = meritPoints;
            shareLevel.textContent = levels[currentLevel].name;
            sharePrayCount.textContent = prayCount;
            
            // éšæœºé€‰æ‹©ä¸€å¥ä½›æ•™ç»å…¸
            const randomQuote = buddhistQuotes[Math.floor(Math.random() * buddhistQuotes.length)];
            buddhistQuote.textContent = randomQuote.quote;
            quoteSource.textContent = "â€”" + randomQuote.source;
            
            // æ˜¾ç¤ºå¼¹çª—
            shareModal.classList.remove('hidden');
            
            // æ·»åŠ æ‰“å¼€åŠ¨ç”»
            shareModal.style.opacity = '0';
            setTimeout(() => {
                shareModal.style.opacity = '1';
            }, 10);
        }
        
        function closeShareModal() {
            shareModal.style.opacity = '0';
            setTimeout(() => {
                shareModal.classList.add('hidden');
            }, 300);
        }
        
        function handleShare(platform) {
            const shareText = `ğŸ§˜â€â™‚ï¸ æˆ‘åœ¨èµ›åšæ‹œä½›ä¸­å·²ä¿®è¡Œ${prayCount}æ¬¡ï¼Œç§¯ç´¯åŠŸå¾·${meritPoints}ç‚¹ï¼Œè¾¾åˆ°${levels[currentLevel].name}å¢ƒç•Œï¼ä¸€èµ·æ¥ä¿®è¡Œå§ï¼âœ¨`;
            
            switch(platform) {
                case 0: // å¾®ä¿¡
                    showBlessing("ğŸ“± å¾®ä¿¡åˆ†äº«åŠŸèƒ½å·²è§¦å‘ï¼");
                    // å®é™…åº”ç”¨ä¸­å¯ä»¥è°ƒç”¨å¾®ä¿¡åˆ†äº«API
                    break;
                case 1: // æŠ–éŸ³
                    showBlessing("ğŸµ æŠ–éŸ³åˆ†äº«åŠŸèƒ½å·²è§¦å‘ï¼");
                    // å®é™…åº”ç”¨ä¸­å¯ä»¥è°ƒç”¨æŠ–éŸ³åˆ†äº«API
                    break;
                case 2: // QQ
                    showBlessing("ğŸ’¬ QQåˆ†äº«åŠŸèƒ½å·²è§¦å‘ï¼");
                    // å®é™…åº”ç”¨ä¸­å¯ä»¥è°ƒç”¨QQåˆ†äº«API
                    break;
                case 3: // å¤åˆ¶
                    navigator.clipboard.writeText(shareText).then(() => {
                        showBlessing("ğŸ“‹ åˆ†äº«å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼");
                    }).catch(() => {
                        showBlessing("ğŸ“‹ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶åˆ†äº«å†…å®¹");
                    });
                    break;
            }
            
            // åˆ†äº«åå¢åŠ é¢å¤–åŠŸå¾·å¥–åŠ±
            meritPoints += 8;
            updateDisplay();
            showBlessing("ğŸ‰ å¸ƒé“åˆ†äº«è·å¾—é¢å¤–åŠŸå¾· +8ï¼");
            
            // å…³é—­å¼¹çª—
            setTimeout(() => {
                closeShareModal();
            }, 1000);
        }
        
        // æ¸¸æˆç»“æŸåºåˆ—
        function gameOverSequence() {
            gameOver = true;
            lifePoints = 0;
            updateDisplay();
            
            // æ˜¾ç¤ºæœ€ç»ˆæ•°æ®
            finalMerit.textContent = meritPoints;
            finalLevel.textContent = levels[currentLevel].name;
            finalPrayCount.textContent = prayCount;
            
            // æ˜¾ç¤ºæ¸¸æˆç»“æŸå¼¹çª—
            setTimeout(() => {
                gameOverModal.classList.remove('hidden');
                gameOverModal.style.opacity = '0';
                setTimeout(() => {
                    gameOverModal.style.opacity = '1';
                }, 10);
            }, 1000);
        }
        
        // é‡å¯æ¸¸æˆ
        function restartGame() {
            meritPoints = 0;
            prayCount = 0;
            currentLevel = 0;
            lifePoints = 120;
            wealthPoints = 60;
            relicPoints = 0;
            charityCount = 0;
            gameOver = false;
            lastRelicTime = Date.now();
            activeBuffs = {};
            fortunePoints = 0;
            totalActions = 0;
            
            // é‡ç½®æ‰€æœ‰æŒ‰é’®å†·å´
            Object.keys(buttonCooldowns).forEach(key => {
                delete buttonCooldowns[key];
            });
            
            // æ¢å¤æ‰€æœ‰æŒ‰é’®çŠ¶æ€
            [prayButton, drumButton, charityButton, scriptButton, fastButton, meditateButton].forEach(button => {
                if (button) {
                    button.disabled = false;
                    button.style.opacity = '1';
                    button.style.cursor = 'pointer';
                    const buttonText = button.querySelector('span');
                    if (buttonText) {
                        // æ¢å¤åŸå§‹æ–‡æœ¬
                        const buttonTexts = {
                            'prayButton': 'ğŸ™ æ‹œä½›ç¥ˆç¦',
                            'drumButton': 'ğŸ¥ æ•²æœ¨é±¼',
                            'charityButton': 'ğŸ’ è¡Œå–„äº‹',
                            'scriptButton': 'ğŸ“œ æŠ„ç»ä¹¦',
                            'fastButton': 'ğŸ¥¬ åƒæ–‹å¿µä½›',
                            'meditateButton': 'ğŸ§˜ ç¦…å®šå†¥æƒ³'
                        };
                        buttonText.textContent = buttonTexts[button.id] || buttonText.textContent;
                    }
                }
            });
            
            // é‡ç½®æˆå°±
            achievements.forEach(achievement => {
                achievement.classList.remove('text-yellow-300');
                achievement.classList.add('text-gray-500');
                achievement.querySelector('span').textContent = 'ğŸ”’';
            });
            
            // æ›´æ–°æ˜¾ç¤º
            updateDisplay();
            
            // éšè—å¼¹çª—
            gameOverModal.style.opacity = '0';
            setTimeout(() => {
                gameOverModal.classList.add('hidden');
            }, 300);
            
            // æ˜¾ç¤ºé‡ç”Ÿç¥ç¦
            showBlessing("ğŸŒŸ é‡è·æ–°ç”Ÿï¼Œå¼€å§‹æ–°çš„ä¿®è¡Œä¹‹è·¯ï¼");
        }
        
        // ç™»å½•ç³»ç»ŸåŠŸèƒ½å‡½æ•°
        function openLoginModal() {
            if (isLoggedIn) {
                // å¦‚æœå·²ç™»å½•ï¼Œæ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
                updateUserInfo();
                loginForm.classList.add('hidden');
                userInfo.classList.remove('hidden');
            } else {
                // å¦‚æœæœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•è¡¨å•
                loginForm.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
            
            loginModal.classList.remove('hidden');
            loginModal.style.opacity = '0';
            setTimeout(() => {
                loginModal.style.opacity = '1';
            }, 10);
        }
        
        function closeLoginModalFunc() {
            loginModal.style.opacity = '0';
            setTimeout(() => {
                loginModal.classList.add('hidden');
            }, 300);
        }
        
        function handleLogin() {
            const user = username.value.trim();
            const pass = password.value.trim();
            
            if (!user || !pass) {
                showBlessing("âš ï¸ è¯·è¾“å…¥æ³•å·å’Œå¯†ç ï¼");
                return;
            }
            
            // æ¨¡æ‹Ÿç™»å½•éªŒè¯ï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥è°ƒç”¨åç«¯APIï¼‰
            const savedUser = localStorage.getItem('user_' + user);
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                if (userData.password === pass) {
                    // ç™»å½•æˆåŠŸ
                    isLoggedIn = true;
                    currentUser = user;
                    userStats = userData.stats || userStats;
                    
                    // æ›´æ–°ç™»å½•æŒ‰é’®æ˜¾ç¤º
                    loginButton.innerHTML = `ğŸ‘¤ ${user}`;
                    
                    // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
                    updateUserInfo();
                    loginForm.classList.add('hidden');
                    userInfo.classList.remove('hidden');
                    
                    showBlessing("ğŸ‰ ç™»å½•æˆåŠŸï¼æ¬¢è¿å›æ¥ï¼Œ" + user + "ï¼");
                    
                    // æ¸…ç©ºè¾“å…¥æ¡†
                    username.value = '';
                    password.value = '';
                } else {
                    showBlessing("âŒ å¯†ç é”™è¯¯ï¼");
                }
            } else {
                showBlessing("âŒ ç”¨æˆ·ä¸å­˜åœ¨ï¼è¯·å…ˆæ³¨å†Œã€‚");
            }
        }
        
        function handleRegister() {
            const user = username.value.trim();
            const pass = password.value.trim();
            
            if (!user || !pass) {
                showBlessing("âš ï¸ è¯·è¾“å…¥æ³•å·å’Œå¯†ç ï¼");
                return;
            }
            
            if (user.length < 2 || user.length > 12) {
                showBlessing("âš ï¸ æ³•å·é•¿åº¦åº”åœ¨2-12ä¸ªå­—ç¬¦ä¹‹é—´ï¼");
                return;
            }
            
            if (pass.length < 4) {
                showBlessing("âš ï¸ å¯†ç è‡³å°‘éœ€è¦4ä¸ªå­—ç¬¦ï¼");
                return;
            }
            
            // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²å­˜åœ¨
            const existingUser = localStorage.getItem('user_' + user);
            if (existingUser) {
                showBlessing("âŒ æ­¤æ³•å·å·²è¢«ä½¿ç”¨ï¼");
                return;
            }
            
            // åˆ›å»ºæ–°ç”¨æˆ·
            const newUser = {
                password: pass,
                stats: {
                    totalMerit: 0,
                    totalPray: 0,
                    highestLevel: 0,
                    registrationDate: new Date().toISOString(),
                    lastLogin: new Date().toISOString()
                }
            };
            
            // ä¿å­˜ç”¨æˆ·æ•°æ®
            localStorage.setItem('user_' + user, JSON.stringify(newUser));
            
            // è‡ªåŠ¨ç™»å½•
            isLoggedIn = true;
            currentUser = user;
            userStats = newUser.stats;
            
            // æ›´æ–°ç™»å½•æŒ‰é’®æ˜¾ç¤º
            loginButton.innerHTML = `ğŸ‘¤ ${user}`;
            
            // æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯
            updateUserInfo();
            loginForm.classList.add('hidden');
            userInfo.classList.remove('hidden');
            
            showBlessing("ğŸ‰ æ³¨å†ŒæˆåŠŸï¼æ¬¢è¿åŠ å…¥ä¿®è¡Œä¹‹è·¯ï¼Œ" + user + "ï¼");
            
            // æ¸…ç©ºè¾“å…¥æ¡†
            username.value = '';
            password.value = '';
        }
        
        function updateUserInfo() {
            if (!isLoggedIn || !currentUser) return;
            
            displayUsername.textContent = currentUser;
            userLevel.textContent = levels[Math.max(currentLevel, userStats.highestLevel)].name;
            userTotalMerit.textContent = userStats.totalMerit;
            userTotalPray.textContent = userStats.totalPray;
            userHighestLevel.textContent = levels[userStats.highestLevel].name;
            
            // è®¡ç®—æ³¨å†Œå¤©æ•°
            if (userStats.registrationDate) {
                const regDate = new Date(userStats.registrationDate);
                const today = new Date();
                const daysDiff = Math.floor((today - regDate) / (1000 * 60 * 60 * 24)) + 1;
                userDays.textContent = daysDiff;
            }
        }
        
        function handleSaveProgress() {
            if (!isLoggedIn || !currentUser) {
                showBlessing("âš ï¸ è¯·å…ˆç™»å½•ï¼");
                return;
            }
            
            // æ›´æ–°ç”¨æˆ·ç»Ÿè®¡
            userStats.totalMerit += meritPoints;
            userStats.totalPray += prayCount;
            userStats.highestLevel = Math.max(userStats.highestLevel, currentLevel);
            userStats.lastLogin = new Date().toISOString();
            
            // ä¿å­˜å½“å‰æ¸¸æˆè¿›åº¦
            const gameData = {
                meritPoints,
                prayCount,
                currentLevel,
                lifePoints,
                wealthPoints,
                charityCount,
                achievements: Array.from(achievements).map(a => a.classList.contains('text-yellow-300'))
            };
            
            // è·å–ç”¨æˆ·æ•°æ®å¹¶æ›´æ–°
            const userData = JSON.parse(localStorage.getItem('user_' + currentUser));
            userData.stats = userStats;
            userData.gameData = gameData;
            
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('user_' + currentUser, JSON.stringify(userData));
            
            showBlessing("ğŸ’¾ è¿›åº¦ä¿å­˜æˆåŠŸï¼");
            updateUserInfo();
        }
        
        function handleLoadProgress() {
            if (!isLoggedIn || !currentUser) {
                showBlessing("âš ï¸ è¯·å…ˆç™»å½•ï¼");
                return;
            }
            
            const userData = JSON.parse(localStorage.getItem('user_' + currentUser));
            if (userData && userData.gameData) {
                const gameData = userData.gameData;
                
                // æ¢å¤æ¸¸æˆæ•°æ®
                meritPoints = gameData.meritPoints || 0;
                prayCount = gameData.prayCount || 0;
                currentLevel = gameData.currentLevel || 0;
                lifePoints = gameData.lifePoints || 120;
                wealthPoints = gameData.wealthPoints || 60;
                charityCount = gameData.charityCount || 0;
                gameOver = false;
                
                // æ¢å¤æˆå°±çŠ¶æ€
                if (gameData.achievements) {
                    achievements.forEach((achievement, index) => {
                        if (gameData.achievements[index]) {
                            achievement.classList.remove('text-gray-500');
                            achievement.classList.add('text-yellow-300');
                            achievement.querySelector('span').textContent = 'ğŸ†';
                        }
                    });
                }
                
                updateDisplay();
                showBlessing("ğŸ“¥ è¿›åº¦è¯»å–æˆåŠŸï¼");
            } else {
                showBlessing("âš ï¸ æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„è¿›åº¦ï¼");
            }
        }
        
        function handleLogout() {
            isLoggedIn = false;
            currentUser = null;
            userStats = {
                totalMerit: 0,
                totalPray: 0,
                highestLevel: 0,
                registrationDate: null,
                lastLogin: null
            };
            
            // æ¢å¤ç™»å½•æŒ‰é’®æ˜¾ç¤º
            loginButton.innerHTML = 'ğŸ‘¤ æ³•å·';
            
            // æ˜¾ç¤ºç™»å½•è¡¨å•
            loginForm.classList.remove('hidden');
            userInfo.classList.add('hidden');
            
            showBlessing("ğŸ‘‹ å·²é€€å‡ºç™»å½•ï¼Œæ„Ÿè°¢æ‚¨çš„ä¿®è¡Œï¼");
            closeLoginModalFunc();
        }
        
        // èˆåˆ©å­ç³»ç»ŸåŠŸèƒ½
        function calculateRelicPerHour() {
            let relicPerHour = 0;
            achievements.forEach(achievement => {
                if (achievement.classList.contains('text-yellow-300')) {
                    const relicValue = parseInt(achievement.dataset.relic);
                    relicPerHour += relicValue;
                }
            });
            return relicPerHour;
        }
        
        function updateRelicTimer() {
            const relicPerHour = calculateRelicPerHour();
            if (relicPerHour === 0) {
                nextRelicTimeEl.textContent = "éœ€è¦è§£é”æˆå°±";
                return;
            }
            
            // æ£€æŸ¥æ—¶é—´æ˜¯å¦ä¸º0ï¼Œå¦‚æœæ˜¯åˆ™æš‚åœèˆåˆ©äº§å‡º
            if (lifePoints <= 0) {
                nextRelicTimeEl.textContent = "æ—¶é—´è€—å°½ï¼Œäº§å‡ºæš‚åœ";
                return;
            }
            
            const now = Date.now();
            const timeSinceLastRelic = now - lastRelicTime;
            const timePerRelic = (60 * 1000) / relicPerHour; // æµ‹è¯•æ¨¡å¼ï¼šæ¯åˆ†é’Ÿäº§å‡ºèˆåˆ©ï¼ˆæ­£å¼ç‰ˆæœ¬åº”è¯¥æ˜¯60 * 60 * 1000ï¼‰
            
            if (timeSinceLastRelic >= timePerRelic) {
                // å¯ä»¥è·å¾—èˆåˆ©
                const relicsToGain = Math.floor(timeSinceLastRelic / timePerRelic);
                relicPoints += relicsToGain;
                lastRelicTime = now - (timeSinceLastRelic % timePerRelic);
                updateDisplay();
                
                if (relicsToGain > 0) {
                    showBlessing(`âœ¨ è·å¾— ${relicsToGain} ä¸ªèˆåˆ©ï¼`);
                }
            }
            
            // æ›´æ–°ä¸‹æ¬¡è·å¾—æ—¶é—´æ˜¾ç¤º
            const timeUntilNext = timePerRelic - (now - lastRelicTime);
            const minutes = Math.floor(timeUntilNext / (1000 * 60));
            const seconds = Math.floor((timeUntilNext % (1000 * 60)) / 1000);
            nextRelicTimeEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function startRelicTimer() {
            if (relicTimer) clearInterval(relicTimer);
            relicTimer = setInterval(updateRelicTimer, 1000);
        }
        
        function openRelicShop() {
            shopRelicCount.textContent = relicPoints;
            relicShopModal.classList.remove('hidden');
            relicShopModal.style.opacity = '0';
            setTimeout(() => {
                relicShopModal.style.opacity = '1';
            }, 10);
        }
        
        function closeRelicShopModal() {
            relicShopModal.style.opacity = '0';
            setTimeout(() => {
                relicShopModal.classList.add('hidden');
            }, 300);
        }
        
        function handleRelicPurchase(button) {
            const type = button.dataset.type;
            const cost = parseInt(button.dataset.cost);
            
            if (relicPoints < cost) {
                showBlessing("âœ¨ èˆåˆ©ä¸è¶³ï¼");
                return;
            }
            
            relicPoints -= cost;
            
            if (type === 'life') {
                const amount = parseInt(button.dataset.amount);
                if (amount === 120) {
                    lifePoints = 120; // æ»¡è¡€å¤æ´»
                    showBlessing("ğŸ’– æ»¡è¡€å¤æ´»ï¼æ—¶é—´å·²æ¢å¤è‡³120ï¼");
                } else {
                    lifePoints += amount;
                    if (lifePoints > 120) lifePoints = 120;
                    showBlessing(`ğŸ’– æ—¶é—´å¢åŠ  ${amount} ç‚¹ï¼`);
                }
            } else if (type === 'gift') {
                const gift = button.dataset.gift;
                handleGiftEffect(gift);
            }
            
            updateDisplay();
            shopRelicCount.textContent = relicPoints;
            
            // æŒ‰é’®åé¦ˆ
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = 'scale(1)';
            }, 150);
        }
        
        function handleGiftEffect(giftName) {
            switch(giftName) {
                case 'åŠŸå¾·åŠ é€Ÿå™¨':
                    activeBuffs.meritBoost = Date.now() + (60 * 60 * 1000); // 1å°æ—¶
                    showBlessing("ğŸš€ åŠŸå¾·åŠ é€Ÿå™¨æ¿€æ´»ï¼1å°æ—¶å†…ä¿®è¡ŒåŠŸå¾·ç¿»å€ï¼");
                    break;
                case 'æ™ºæ…§ä¹‹å…‰':
                    if (currentLevel < levels.length - 1) {
                        const oldMerit = meritPoints;
                        meritPoints = levels[currentLevel + 1].requirement;
                        const meritGained = meritPoints - oldMerit;
                        showMeritPopup(meritGained);
                        showBlessing("ğŸ’¡ æ™ºæ…§ä¹‹å…‰ç…§è€€ï¼å¢ƒç•Œç›´æ¥æå‡ï¼");
                    } else {
                        meritPoints += 800;
                        showMeritPopup(800);
                        showBlessing("ğŸ’¡ æ™ºæ…§ä¹‹å…‰ç…§è€€ï¼åŠŸå¾·å¤§å¹…å¢åŠ ï¼");
                    }
                    break;
                case 'è´¢å¯Œå®ç®±':
                    wealthPoints += 40;
                    if (wealthPoints > 100) wealthPoints = 100;
                    showBlessing("ğŸ’° è´¢å¯Œå®ç®±å¼€å¯ï¼è·å¾—40è´¢å¯Œå€¼ï¼");
                    break;
                case 'ä½›ç¥–æŠ¤ä½‘':
                    activeBuffs.lifeProtection = Date.now() + (24 * 60 * 60 * 1000); // 24å°æ—¶
                    showBlessing("ğŸ™ ä½›ç¥–æŠ¤ä½‘æ¿€æ´»ï¼24å°æ—¶å†…æ—¶é—´æ¶ˆè€—å‡åŠï¼");
                    break;
                case 'ç¥ç§˜ç¤¼ç›’':
                    const randomRewards = [
                        () => { 
                            meritPoints += 1500; 
                            showMeritPopup(1500);
                            return "è·å¾—1500åŠŸå¾·å€¼ï¼"; 
                        },
                        () => { lifePoints = 120; return "æ—¶é—´å®Œå…¨æ¢å¤ï¼"; },
                        () => { wealthPoints = 100; return "è´¢å¯Œå€¼æ»¡é¢ï¼"; },
                        () => { relicPoints += 80; return "è·å¾—80ä¸ªèˆåˆ©ï¼"; },
                        () => { 
                            activeBuffs.meritBoost = Date.now() + (3 * 60 * 60 * 1000);
                            activeBuffs.lifeProtection = Date.now() + (3 * 60 * 60 * 1000);
                            return "è·å¾—3å°æ—¶è¶…çº§å¢ç›Šï¼";
                        }
                    ];
                    const randomReward = randomRewards[Math.floor(Math.random() * randomRewards.length)];
                    const rewardText = randomReward();
                    showBlessing("ğŸ ç¥ç§˜ç¤¼ç›’ï¼š" + rewardText);
                    break;
            }
        }
        
        // ä¿®æ”¹ä¿®è¡Œå‡½æ•°ä»¥æ”¯æŒå¢ç›Šæ•ˆæœ
        function getModifiedMerit(baseMerit) {
            let finalMerit = baseMerit;
            
            // æ£€æŸ¥åŠŸå¾·åŠ é€Ÿå™¨
            if (activeBuffs.meritBoost && Date.now() < activeBuffs.meritBoost) {
                finalMerit *= 2;
            }
            
            return finalMerit;
        }
        
        function getModifiedLifeCost(baseCost) {
            let finalCost = baseCost;
            
            // æ£€æŸ¥ä½›ç¥–æŠ¤ä½‘
            if (activeBuffs.lifeProtection && Date.now() < activeBuffs.lifeProtection) {
                finalCost = Math.ceil(finalCost / 2);
            }
            
            return finalCost;
        }
        
        // æ—¶é—´è¡°å‡ç³»ç»Ÿ - æ¯2åˆ†é’Ÿå‡å°‘1ç‚¹æ—¶é—´
        function startLifeDecay() {
            // æµ‹è¯•æ¨¡å¼ï¼šæ¯2åˆ†é’Ÿå‡å°‘1ç‚¹æ—¶é—´ï¼ˆæ­£å¼ç‰ˆæœ¬åº”è¯¥æ˜¯60 * 60 * 1000ï¼‰
            setInterval(() => {
                if (!gameOver && lifePoints > 0) {
                    lifePoints -= 1;
                    updateDisplay();
                    
                    if (lifePoints <= 0) {
                        gameOverSequence();
                    } else if (lifePoints <= 15) {
                        showBlessing("âš ï¸ æ—¶é—´å³å°†è€—å°½ï¼è¯·å°½å¿«è¡¥å……ï¼");
                    }
                }
            }, 2 * 60 * 1000); // æµ‹è¯•æ¨¡å¼ï¼š2åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
        }

    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9761b69905ad0930',t:'MTc1NjM2MjEzNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
